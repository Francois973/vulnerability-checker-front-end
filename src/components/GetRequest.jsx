import React, { useState } from "react";
import { BsClipboardCheck } from "react-icons/bs";
import { useCopyToClipboard } from "usehooks-ts";

const GetRequest = () => {
  const [copiedIndex, setCopiedIndex] = useState(-1);
  const [value, copy] = useCopyToClipboard();

  const result = {
    name: "vulnerability-checker-back-end",
    uuid: "556cbd7c-241f-4aed-a490-a8b544bdf9b6",
    status: "New",
    url: "https://github.com/francois973/vulnerability-checker-back-end",
    ecosystems: {
      RUST: "pending",
      ERLANG: "pending",
      RUBYGEMS: "pending",
      NPM: "pending",
    },
    created_at: "2023-03-11T15:42:42.746Z",
    vulnerabilities: [],
  };

  const url = "https://api.scanrepo.fr/api/v1/projects/:uuid";
  const availableSeverityFilters = ["CRITICAL", "HIGH", "MODERATE", "LOW"];
  const availableEcosystemsFilters = ["ERLANG", "RUBGEMS", "RUST", "NPM"];

  const filters = "ecosystem: RUBYGEMS, severity: MODERATE";

  const jsonResult = JSON.stringify(result, null, 2);

  const handleClick = (index, value) => {
    setCopiedIndex(index);
    copy(value);
  };

  return (
    <div className="py-5 mb-10">
      <p>
        From the result of the previous query, we need to retrieve the encrypted
        id of the project "uuid". This will be used to make our query to
        retrieve the vulnerabilities of our project.
      </p>
      <pre className="p-4 rounded-sm bg-dark-github flex sm:flex-row flex-col justify-between items-center mt-5 sm:overflow-hidden overflow-auto">
        <code className="value text-[14px] w-96">
          https://api.scanrepo.fr/api/v1/projects/:uuid
        </code>
        <div className="flex flex-col items-center">
          <BsClipboardCheck
            className="text-right cursor-pointer hover:bg-slate-600"
            onClick={() => handleClick(0, url)}
          />
          <p className="text-[10px]">{copiedIndex === 0 ? "Copied!" : ""}</p>
        </div>
      </pre>
      <div className="mt-5">
        <p>We have the possibility to add some filters like :</p>
        <div className="flex flex-row items-center gap-x-7">
          {availableSeverityFilters.map((s) => {
            return (
              <ul>
                <li className="text-[14px]">{s}/</li>
              </ul>
            );
          })}
          {availableEcosystemsFilters.map((e) => {
            return (
              <ul>
                <li className="text-[14px]">{e}/</li>
              </ul>
            );
          })}
        </div>
        <pre className="p-4 rounded-sm bg-dark-github flex sm:flex-row flex-col justify-between items-center mt-5  sm:overflow-hidden overflow-auto">
          <code className="value text-[14px]">
            ecosystem: RUBYGEMS, severity: "MODERATE"
          </code>
          <div className="flex flex-col items-center">
            <BsClipboardCheck
              className="text-right cursor-pointer hover:bg-slate-600"
              onClick={() => handleClick(1, filters)}
            />
            <p className="text-[10px]">{copiedIndex === 1 ? "Copied!" : ""}</p>
          </div>
        </pre>

        <div className="mt-5 mb-6">
          <a
            href="https://vulnerability-back-6wfe.onrender.com/api/v1/projects/59e704d1-33e2-44fe-b44f-53356cd968d6"
            className="cursor-pointer underline underline-offset-4"
            target="_blank"
          >
            Click to see an exemple of projet with vulnerabilities
          </a>
        </div>
      </div>
    </div>
  );
};

export default GetRequest;
