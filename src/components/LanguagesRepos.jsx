import React from "react";
import { useState, useEffect } from "react";

const LanguagesRepos = ({ url }) => {
  const [languages, setLanguages] = useState("");

  useEffect(() => {
    const fetchLanguages = async () => {
      try {
        const response = await fetch(`${url}`, {
          headers: new Headers({
            Authorization: JSON.stringify(import.meta.env),
          }),
        });
        if (!response.ok) {
          throw new Error(
            "Sorry... This username is maybe unknown or the limit is over"
          );
        } else {
          const data = await response.json();
          setLanguages(data);
        }
      } catch (error) {
        setError(error.message);
      }
    };
    fetchLanguages();
  }, [url]);

  const firstLanguage = Object.keys(languages)[0];
  console.log(firstLanguage);
  return (
    <div className="pt-4 flex flex-row relative">
      {firstLanguage == "Ruby" ? (
        <img
          src="https://raw.githubusercontent.com/devicons/devicon/master/icons/ruby/ruby-original.svg"
          alt="ruby"
          className="h-6 w-6 absolute top-[-6vh] left-[38vw]"
        />
      ) : firstLanguage == "JavaScript" ? (
        <img
          src="https://upload.wikimedia.org/wikipedia/commons/9/99/Unofficial_JavaScript_logo_2.svg"
          alt="ruby"
          className="h-6 w-6 absolute top-[-6vh] left-[38vw]"
        />
      ) : firstLanguage == "Elixir" ? (
        <img
          src="https://www.vectorlogo.zone/logos/elixir-lang/elixir-lang-icon.svg"
          alt="ruby"
          className="h-6 w-6 absolute top-[-6vh] left-[38vw]"
        />
      ) : firstLanguage == "Python" ? (
        <img
          src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Python-logo-notext.svg/1869px-Python-logo-notext.svg.png"
          alt="ruby"
          className="h-6 w-6 absolute top-[-6vh] left-[38vw]"
        />
      ) : firstLanguage == "C" ? (
        <img
          src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/C_Programming_Language.svg/695px-C_Programming_Language.svg.png"
          alt="ruby"
          className="h-6 w-6 absolute top-[-6vh] left-[38vw]"
        />
      ) : null}
      <div>
        {Object.entries(languages).map(([key, value]) => (
          <li key={key} className="pt-1 flex flex-row gap-x-5 justify-start">
            <span className="w-[10vw]">{`${key}:`}</span>
            <span className="w-[10vw]">{`${value} lines`}</span>
          </li>
        ))}
      </div>
    </div>
  );
};

export default LanguagesRepos;
